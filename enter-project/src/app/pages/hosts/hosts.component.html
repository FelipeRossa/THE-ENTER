<div class="hosts-page">
    <div class="header">
        <input type="text" placeholder="Pesquisar por IP ou host..." [(ngModel)]="search" (input)="filterHosts()" />
        <button class="new-host-btn" (click)="modalNovoGrupo.abrirModal()">Novo Grupo</button>
    </div>

    <div class="host-list">
        <div class="table-container" *ngFor="let grupo of filteredHosts">
            <div class="group-header">
                <span class="badge" (click)="modalNovoGrupo.abrirModal(grupo)"
                    style="cursor:pointer; font-size: 1.2rem;" [ngStyle]="{ 'background-color': grupo.corExadecimal }">
                    <!-- <span class="badge" > -->
                    {{ grupo.titulo }}
                    <!-- </span> -->
                </span>
                <span class="switch-container" *ngIf="grupo.titulo != 'SGD'">
                    <label class="switch" style="gap: 0.5rem;">
                        <input type="checkbox" [(ngModel)]="grupo.onOff" (click)="ligaDesligaGrupo(grupo)">
                        <span class="slider round"></span>
                    </label>
                    <button (click)="modalCadastroHost.abrirModal(grupo)" class="btn btn-sm btn-outline-secondary">
                        Novo Host
                    </button>
                </span>
            </div>

            <table class="table">
                <thead>
                </thead>
                <tbody>
                    <tr *ngFor="let host of grupo.hosts" (click)="modalCadastroHost.abrirModal(grupo, host)">
                        <td class="align-items-center gap-2">
                            <div class="switch-container" (click)="$event.stopPropagation()">
                                <label class="switch" style="gap: 0.5rem;">
                                    <input type="checkbox" [checked]="host.onOff"
                                        (click)="ligaDesligaHost(host, grupo)">
                                    <span class="slider round"></span>
                                </label>

                                <i class="bi" [ngClass]="{
                                'bi-lightbulb-fill': host.onOff,
                                'bi-lightbulb': !host.onOff,
                                'lamp-on': host.onOff
                                }"></i>
                            </div>

                        </td>
                        <td>{{ host.ip }}</td>
                        <td style="justify-content: start; display: flex">{{ host.nmHost }}</td>
                        <td><span class="badge" [ngStyle]="{ 'background-color': host.corExadecimal }"
                                style="color: black;">{{ host.comentario }}</span></td>
                    </tr>
                </tbody>
            </table>
        </div>

    </div>
</div>

<app-cadastro-grupo-host #modalNovoGrupo (grupoCriado)="criarGrupoEAdicionarHost($event)"></app-cadastro-grupo-host>

<app-cadastro-hosts #modalCadastroHost (hostSalvo)="loadHosts()"></app-cadastro-hosts>

<app-error-modal [modalTitleErr]="modalTitle" [mensagemErr]="mensagemErro" (onClose)="loadHosts()"
    #erroModal></app-error-modal>